#发现漏洞按捺不住激动的小情绪
##漏洞概要
- 漏洞标题：NEU 新OJ 图片上传漏洞
- 漏洞作者：xfang
- 提交时间：2016-05-18 22:28
- 漏洞类型：xss
- 危险等级：低

##漏洞详情
- 发现漏洞 
在浏览个人设置界面源码时发现如下上传个人图片代码
```
		<td>
			<input name="image" type="file" accept="image/*">
		</td>
```
在机房的旧版搜狗浏览器上 ```accept="image/*"``` 失效，可以上传任何文件。于是尝试上传一段文档，发现访问对应原图片链接时，浏览器会自动加载文档内容。
- 漏洞重现
在标准浏览器上，可以把对应的文档后缀改成 ```jpg``` 进行上传，访问对应链接，就能加载对应的文档。
- 跨站脚本攻击漏洞证明
当我们上传一段附加````javascript``` 的HTML文件时，访问对应链接，能够加载对应js代码，实现跨站脚本攻击。
- 漏洞试验链接
[测试](http://202.118.31.226/avatar/673)


## 评价[已修复]

* 危险类型 低
* 攻击需要角色 所有可以登陆NEUOJ的学生级别用户
* 导致原因 没有检查上传的文件的mimetype
* 解决方法 在上传头像的时候添加了对文件mimetype的检查
* 感谢你的反馈
